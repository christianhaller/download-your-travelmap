const cookie =
  "TAUnique=%1%enc%3AruzHIw%2BF%2F0MoHOL16X4ARJMMDEofp%2Bob3c5HBJgs6sCZKjdaOguzW4KUz6NiRlw3Nox8JbUSTxk%3D; TADCID=d_okamYf7kdhkxTsABQCmq6heh9ZSU2yA8SXn9Wv5Hz-icEv_59hAdVaAA0nk9pn38qCspqxXYZ6D_1m1oVcUyq1_TUnFmepoE8; TASameSite=1; __vt=r0_ksRC-lR2EpXw4ABQCwRB1grfcRZKTnW7buAoPsSzcKT2CzaOSmgEWei9wXOLD0zSBVxCFH98mwpOoPAEAkz2IQGHDa01RbWim7L9KjPKFilk1kg_HlUuAMM8Rr1DiALGkLOTWPTsLN_eP3IJ97GdB; TASID=077E8ACDD31748AA70662D4869882995; TASession=V2ID.077E8ACDD31748AA70662D4869882995*SQ.1*LS.Home*HS.recommended*ES.popularity*DS.5*SAS.popularity*FPS.oldFirst*FA.1*DF.0*TRA.true; TASSK=enc%3AAINr9v%2B9jo6w19kHQrVcQ4cOGwk97qgnVQh6veA2YvtidUZ%2FmZA8EyIsoUinz5chc8bzcUIDBfK80teu6BdFhTDrkmi%2F6BjjkbVFjdtObsL59LxE5mOiOT3d3PM8xPT%2FXw%3D%3D; PAC=AKm3c_uVS9emNcvEkjXkGlXuxHrfm4sJzr3QkSMgLfg3MI7epn6l7TsTBwS_BIIR5zj-oCH6ZEE8XOrvWypkgXs_rcKJGj60Zuzcdiei10NV_aPgqMhjtahWK-RCXgB0Uj9eRTR5YOKV8UgpOIwxAcs%3D; TART=%1%enc%3AaB6e1kE6C8FEUgM2wyfgKN5N2ltj5hzgWQJmgtz5wddUzOEu8zNESN%2BEk20gbvO%2BfTM2Cx7kRNA%3D; OptanonAlertBoxClosed=2024-04-19T07:24:58.089Z; eupubconsent-v2=CP9T-7AP9T-7AAcABBENAwEsAP_gAEPgACiQKENX_D5ebWti8XZUIbtkaYwP55izokQhBhaIEewFwAOG7BgCB2EwNAV4JiACGBAEkiLBAQNlHABUCQAAAIgRiSCMYkWMgTNKJKBAiFMRO0NYCBxmmgFDWQCY5kosszdxmDeAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAA_cff79LlBQgAswUKiAFsCQgIFAwggQACCMICIAAAAACQFABACAAAnYEAQ6wkAAABAACAAAAAEEQAIAABIAEIgAAAIBAAAAIBAACAAAIBAAQIAAIALAACAAEA0AAICCAQDABAxAiFMCAIAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtGVpAWj4BQIASADoALgA2QCIAGEAToAuQBtgEDggAYAHQArgCIAGEAToBA4MAHAB0AFwAbIBEADCALkAgcIADgA6AGyARAAwgCdAFyAQOFAAwAuAGEAgcMABAGEAgcOADAA6AIgAYQBOgEDgIrkAAQBhAIHEgAYBEADCAQOKABQAdAEQAMIAnQCBw.f_wACHwAAAAA; OTAdditionalConsentString=1~43.46.55.61.70.83.89.93.108.117.122.124.135.136.143.144.147.149.159.192.196.202.211.228.230.239.259.266.286.291.311.320.322.323.327.338.367.371.385.394.397.407.413.415.424.430.436.445.453.486.491.494.495.522.523.540.550.559.560.568.574.576.584.587.591.737.802.803.820.821.839.864.899.904.922.931.938.979.981.985.1003.1027.1031.1040.1046.1051.1053.1067.1085.1092.1095.1097.1099.1107.1135.1143.1149.1152.1162.1166.1186.1188.1205.1215.1226.1227.1230.1252.1268.1270.1276.1284.1290.1301.1307.1312.1345.1356.1364.1375.1403.1415.1416.1421.1423.1440.1449.1455.1495.1512.1516.1525.1540.1548.1555.1558.1570.1577.1579.1583.1584.1591.1603.1616.1638.1651.1653.1659.1667.1677.1678.1682.1697.1699.1703.1712.1716.1721.1725.1732.1745.1750.1765.1782.1786.1800.1810.1825.1827.1832.1838.1840.1842.1843.1845.1859.1866.1870.1878.1880.1889.1899.1917.1929.1942.1944.1962.1963.1964.1967.1968.1969.1978.1985.1987.2003.2008.2027.2035.2039.2047.2052.2056.2064.2068.2072.2074.2088.2090.2103.2107.2109.2115.2124.2130.2133.2135.2137.2140.2145.2147.2150.2156.2166.2177.2183.2186.2205.2213.2216.2219.2220.2222.2225.2234.2253.2279.2282.2292.2305.2309.2312.2316.2322.2325.2328.2331.2334.2335.2336.2337.2343.2354.2357.2358.2359.2370.2376.2377.2387.2392.2400.2403.2405.2407.2411.2414.2416.2418.2425.2440.2447.2461.2462.2465.2468.2472.2477.2481.2484.2486.2488.2493.2498.2499.2501.2510.2517.2526.2527.2532.2535.2542.2552.2563.2564.2567.2568.2569.2571.2572.2575.2577.2583.2584.2596.2604.2605.2608.2609.2610.2612.2614.2621.2628.2629.2633.2636.2642.2643.2645.2646.2650.2651.2652.2656.2657.2658.2660.2661.2669.2670.2677.2681.2684.2687.2690.2695.2698.2713.2714.2729.2739.2767.2768.2770.2772.2784.2787.2791.2792.2798.2801.2805.2812.2813.2816.2817.2821.2822.2827.2830.2831.2834.2838.2839.2844.2846.2849.2850.2852.2854.2860.2862.2863.2865.2867.2869.2873.2874.2875.2876.2878.2880.2881.2882.2883.2884.2886.2887.2888.2889.2891.2893.2894.2895.2897.2898.2900.2901.2908.2909.2916.2917.2918.2919.2920.2922.2923.2927.2929.2930.2931.2940.2941.2947.2949.2950.2956.2958.2961.2963.2964.2965.2966.2968.2973.2975.2979.2980.2981.2983.2985.2986.2987.2994.2995.2997.2999.3000.3002.3003.3005.3008.3009.3010.3012.3016.3017.3018.3019.3024.3025.3028.3034.3038.3043.3048.3052.3053.3055.3058.3059.3063.3066.3068.3070.3073.3074.3075.3076.3077.3078.3089.3090.3093.3094.3095.3097.3099.3100.3106.3109.3112.3117.3119.3126.3127.3128.3130.3135.3136.3145.3150.3151.3154.3155.3163.3167.3172.3173.3182.3183.3184.3185.3187.3188.3189.3190.3194.3196.3209.3210.3211.3214.3215.3217.3219.3222.3223.3225.3226.3227.3228.3230.3231.3234.3235.3236.3237.3238.3240.3244.3245.3250.3251.3253.3257.3260.3270.3272.3281.3288.3290.3292.3293.3296.3299.3300.3306.3307.3309.3314.3315.3316.3318.3324.3328.3330.3331.3531.3731.3831.3931.4131.4531.4631.4731.4831.5231.6931.7031.7235.7831.7931.8931.9731.10231.10631.10831.11031.11531.12831.13632.13731.14237.14332.15731.16831.21233.23031.24431.25731.25931.26031.26831.27731.28031; TATrkConsent=eyJvdXQiOiJTT0NJQUxfTUVESUEiLCJpbiI6IkFEVixBTkEsRlVOQ1RJT05BTCJ9; OptanonConsent=consentId=fe3f29e6-d677-4b8c-a639-05e8e7e439d5&datestamp=Fri+Apr+19+2024+09%3A24%3A58+GMT%2B0200+(Mitteleurop%C3%A4ische+Sommerzeit)&version=202310.2.0&interactionCount=1&isGpcEnabled=0&browserGpcFlag=0&isIABGlobal=false&hosts=&landingPath=NotLandingPage&groups=C0001%3A1%2CC0004%3A1%2CC0002%3A1%2CC0003%3A1%2CV2STACK42%3A1; ab.storage.deviceId.6e55efa5-e689-47c3-a55b-e6d7515a6c5d=%7B%22g%22%3A%2236f9ba24-e7ba-7c14-ee44-5e25cb427d85%22%2C%22c%22%3A1713511411347%2C%22l%22%3A1713511498137%7D; pbjs_sharedId=3f8f774a-2fb5-4008-b8e1-3f04f68feab1; pbjs_sharedId_cst=yiyqLH8s3Q%3D%3D; _ga_QX0Q50ZC9P=GS1.1.1713511498.1.0.1713511498.60.0.0; _ga=GA1.1.227661437.1713511498; ab.storage.sessionId.6e55efa5-e689-47c3-a55b-e6d7515a6c5d=%7B%22g%22%3A%224d1139e9-6ffd-5739-8cd6-d95c78296b36%22%2C%22e%22%3A1713511513552%2C%22c%22%3A1713511498136%2C%22l%22%3A1713511498552%7D; __gads=ID=fca07104ab3f1de2:T=1713511502:RT=1713511502:S=ALNI_MZETbfheK453qYzWXdhnV2b26R7DQ; __gpi=UID=00000df7c54f745e:T=1713511502:RT=1713511502:S=ALNI_MZm1gg5NZwi0yoYTes_hsY_6sjdVg; __eoi=ID=9e57a273b92cb079:T=1713511502:RT=1713511502:S=AA-AfjYWOrlesnHYMiJ6CdMZwetZ; _lr_sampling_rate=100; datadome=tfJ18wX5HrFVrJQYeskq9dj9VRjwm9hy2BEBKAPM8bO1SESI66zX7qsl9r0FUUSOqwMysiWzSntOpmMefKswI3hPGJMZJxNunvQZiwhZxvfA5YjNE2EJlkOuW_MLdeOt";

const request = async (url: URL): Promise<string> => {
  const { href } = url;

  const c = new AbortController();
  const id = setTimeout(() => c.abort(), 2000);

  const res = await fetch(href, {
    signal: c.signal,

    headers: {
      cookie,
    },
    method: "GET",
  });

  clearTimeout(id);
  if (!res.ok) {
    throw new Error(`url ${href} is not ok`);
  }
  return res.text();
};

const requestCookie = async (url: URL) => {
  const res = await fetch("https://www.tripadvisor.de/", {
    headers: {
      accept:
        "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
      "accept-language": "en-US,en;q=0.9",
      "cache-control": "no-cache",
      pragma: "no-cache",
      priority: "u=0, i",
      "sec-ch-device-memory": "8",
      "sec-ch-ua":
        '"Chromium";v="124", "Google Chrome";v="124", "Not-A.Brand";v="99"',
      "sec-ch-ua-arch": '"arm"',
      "sec-ch-ua-full-version-list":
        '"Chromium";v="124.0.6367.62", "Google Chrome";v="124.0.6367.62", "Not-A.Brand";v="99.0.0.0"',
      "sec-ch-ua-mobile": "?0",
      "sec-ch-ua-model": '""',
      cookie,
      "sec-ch-ua-platform": '"macOS"',
      "sec-fetch-dest": "document",
      "sec-fetch-mode": "navigate",
      "sec-fetch-site": "same-origin",
      "sec-fetch-user": "?1",
      "upgrade-insecure-requests": "1",
    },
    referrerPolicy: "strict-origin-when-cross-origin",
    body: null,
    method: "GET",
    mode: "cors",
    credentials: "include",
  });

  return res.status;
};

export { request, requestCookie };
